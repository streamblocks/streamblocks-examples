namespace hetero.spamfilter.sgd:


  @pipeline(flush=true)
  actor Sigmoid() float Exponent ==> float Sig:

    List(type: float, size=512) sig_pos = [ 
      0.5,0.5019531150659532,0.5039061705290805,0.5058591067938315,
      0.5078118642792044,0.5097643834260159,0.5117166047041654,0.5136684686198906,
      0.5156199157230156,0.5175708866141864,0.5195213219520929,0.5214711624606773,
      0.523420348936324,0.5253688222550323,0.5273165233795671,0.5292633933665886,
      0.5312093733737563,0.5331544046668082,0.5350984286266115,0.5370413867561842,
      0.5389832206876841,0.5409238721893666,0.5428632831725052,0.5448013956982781,
      0.5467381519846138,0.5486734944129984,0.5506073655352404,0.5525397080801923,
      0.5544704649604273,0.5563995792788694,0.5583269943353745,0.5602526536332625,
      0.5621765008857981,0.5640984800226174,0.5660185351961015,0.5679366107876933,
      0.5698526514141571,0.5717666019337796,0.5736784074525096,0.575588013330038,
      0.5774953651858118,0.579400408904987,0.5813030906443133,0.583203356837953,
      0.5851011542032312,0.5869964297463166,0.588889130767832,0.5907792048683922,
      0.5926665999540697,0.5945512642417856,0.5964331462646254,0.5983121948770795,
      0.600188359260205,0.6020615889267098,0.6039318337259583,0.6057990438488957,
      0.6076631698328917,0.6095241625665028,0.6113819732941511,0.6132365536207203,
      0.6150878555160665,0.616935831319445,0.6187804337438501,0.6206216158802703,
      0.6224593312018546,0.624293533567992,0.6261241772283034,0.6279512168265432,
      0.6297746074044134,0.6315943044052867,0.6334102636778401,0.6352224414795979,
      0.6370307944803831,0.6388352797656791,0.640635854839898,0.6424324776295582,
      0.6442251064863697,0.6460137001902271,0.6477982179521103,0.6495786194168923,
      0.6513548646660542,0.6531269142203084,0.6548947290421275,0.6566582705381819,
      0.658417500561683,0.6601723814146353,0.6619228758499942,0.6636689470737326,
      0.665410558746814,0.6671476749870737,0.6688802603710086,0.670608279935473,
      0.672331699179286,0.6740504840647448,0.6757646010190476,0.6774740169356273,
      0.679178699175393,0.6808786155678822,0.682573734412324,0.6842640244786128,
      0.6859494550081925,0.6876299957148544,0.689305616785446,0.6909762888804932,
      0.6926419831347361,0.6943026711575786,0.6959583250334526,0.6976089173220981,
      0.6992544210587585,0.7008948097542927,0.7025300573952054,0.7041601384435928,
      0.7057850278370112,0.7074047009882609,0.7090191337850932,0.7106283025898368,
      0.712232184238947,0.713830756042477,0.7154239957834733,0.7170118817172945,
      0.7185943925708561,0.7201715075418013,0.7217432062975979,0.7233094689745646,
      0.7248702761768248,0.7264256089751905,0.7279754489059775,0.7295197779697509,
      0.7310585786300049,0.7325918338117745,0.734119526900183,0.7356416417389247,
      0.7371581626286834,0.7386690743254897,0.7401743620390163,0.7416740114308128,
      0.7431680086124811,0.7446563401437933,0.746138993030751,0.74761595472359,
      0.7490872131147275,0.7505527565366589,0.7520125737597972,0.7534666539902642,
      0.7549149868676283,0.7563575624625937,0.7577943712746406,0.7592254042296177,
      0.7606506526772884,0.7620701083888303,0.7634837635542924,0.7648916107800069,
      0.7662936430859597,0.76768985390312,0.7690802370707283,0.7704647868335476,
      0.7718434978390747,0.7732163651347154,0.7745833841649233,0.7759445507683053,
      0.7772998611746911,0.7786493120021721,0.7799929002541067,0.7813306233160979,
      0.7826624789529376,0.7839884653055251,0.785308580887758,0.786622824583395,
      0.7879311956428947,0.7892336936802291,0.7905303186696747,0.79182107094258,
      0.7931059511841119,0.7943849604299823,0.7956581000631541,0.7969253718105298,
      0.7981867777396212,0.7994423202552038,0.8006920020959544,0.801935826331075,
      0.8031737963569016,0.804405915893501,0.8056321889812553,0.8068526199774353,
      0.8080672135527632,0.8092759746879663,0.8104789086703224,0.811676021090197,
      0.8128673178375735,0.8140528050985784,0.8152324893520001,0.8164063773658039,
      0.8175744761936437,0.8187367931713698,0.8198933359135361,0.8210441123099046,
      0.8221891305219503,0.8233283989793668,0.8244619263765707,0.8255897216692099,
      0.8267117940706734,0.8278281530486042,0.8289388083214156,0.8300437698548124,
      0.8311430478583168,0.8322366527818007,0.8333245953120233,0.8344068863691763,
      0.8354835371034369,0.8365545588915281,0.8376199633332891,0.8386797622482537,
      0.8397339676722393,0.8407825918539462,0.8418256472515684,0.8428631465294143,
      0.8438951025545426,0.8449215283934065,0.8459424373085146,0.8469578427551038,
      0.8479677583778257,0.8489721980074492,0.849971175657575,0.8509647055213694,
      0.8519528019683106,0.8529354795409523,0.8539127529517043,0.8548846370796298,
      0.8558511469672594,0.8568122978174237,0.8577681049901036,0.8587185839992991,
      0.8596637505099167,0.8606036203346761,0.8615382094310357,0.8624675338981391,
      0.8633916099737806,0.8643104540313907,0.8652240825770433,0.8661325122464822,
      0.8670357598021706,0.8679338421303608,0.8688267762381844,0.8697145792507666,
      0.870597268408361,0.8714748610635069,0.8723473746782093,0.8732148268211409,
      0.8740772351648677,0.8749346174830964,0.8757869916479466,0.8766343756272444,
      0.8774767874818407,0.878314245362953,0.8791467675095294,0.8799743722456386,
      0.8807970779778823,0.8816149031928324,0.8824278664544911,0.8832359864017768,
      0.8840392817460332,0.8848377712685633,0.8856314738181876,0.8864204083088262,
      0.8872045937171068,0.8879840490799963,0.888758793492457,0.8895288461051276,
      0.8902942261220291,0.8910549527982959,0.8918110454379297,0.8925625233915799,
      0.8933094060543487,0.8940517128636203,0.8947894632969136,0.8955226768697631,
      0.8962513731336202,0.896975571673783,0.8976952921073469,0.8984105540811842,
      0.8991213772699436,0.8998277813740775,0.9005297861178929,0.9012274112476257,
      0.90192067652954,0.9026096017480523,0.9032942067038784,0.9039745112122062,
      0.9046505351008906,0.9053222982086733,0.9059898203834277,0.9066531214804244,
      0.9073122213606241,0.90796713988899,0.9086178969328287,0.909264512360149,
      0.9099070060380482,0.9105453978311193,0.9111797075998822,0.9118099551992372,
      0.9124361604769414,0.9130583432721083,0.9136765234137297,0.9142907207192192,
      0.9149009549929797,0.9155072460249908,0.91610961358942,0.916708077443256,
      0.9173026573249612,0.9178933729531492,0.9184802440252811,0.9190632902163844,
      0.9196425311777929,0.9202179865359069,0.9207896758909757,0.9213576188158985,
      0.9219218348550491,0.9224823435231172,0.9230391643039738,0.923592316649553,
      0.9241418199787566,0.9246876936763765,0.9252299570920387,0.9257686295391643,
      0.9263037302939515,0.9268352785943768,0.927363293639213,0.9278877945870695,
      0.9284088005554476,0.9289263306198166,0.9294404038127071,0.9299510391228232,
      0.9304582554941719,0.9309620718252101,0.9314625069680097,0.9319595797274409,
      0.9324533088603709,0.9329437130748804,0.9334308110294983,0.9339146213324513,
      0.9343951625409306,0.9348724531603766,0.9353465116437761,0.9358173563909802,
      0.9362850057480346,0.9367494780065266,0.9372107914029487,0.9376689641180752,
      0.9381240142763573,0.9385759599453297,0.9390248191350352,0.9394706097974611,
      0.9399133498259924,0.9403530570548787,0.9407897492587141,0.9412234441519332,
      0.941654159388319,0.9420819125605256,0.9425067211996143,0.9429286027746023,
      0.9433475746920261,0.9437636542955161,0.9441768588653856,0.944587205618231,
      0.9449947117065459,0.9453993942183476,0.9458012701768145,0.946200356539936,
      0.9465966702001757,0.9469902279841446,0.9473810466522863,0.9477691428985743,
      0.94815453335022,0.9485372345673925,0.9489172630429474,0.9492946352021694,
      0.9496693674025232,0.9500414759334155,0.9504109770159683,0.9507778868028013,
      0.9511422213778251,0.9515039967560431,0.9518632288833652,0.9522199336364293,
      0.9525741268224334,0.9529258241789759,0.9532750413739076,0.953621794005189,
      0.9539660976007597,0.9543079676184154,0.9546474194456936,0.9549844683997677,
      0.9553191297273498,0.9556514186046017,0.9559813501370537,0.956308939359532,
      0.9566342012360932,0.9569571506599678,0.9572778024535095,0.9575961713681533,
      0.9579122720843811,0.9582261192116938,0.9585377272885904,0.9588471107825551,
      0.9591542840900507,0.9594592615365182,0.9597620573763841,0.9600626857930734,
      0.96036116089903,0.9606574967357419,0.9609517072737735,0.9612438064128053,
      0.9615338079816756,0.9618217257384336,0.9621075733703927,0.9623913644941934,
      0.9626731126558706,0.9629528313309248,0.9632305339244013,0.9635062337709722,
      0.9637799441350253,0.9640516782107567,0.9643214491222695,0.9645892699236761,
      0.9648551535992067,0.9651191130633208,0.9653811611608242,0.965641310666991,
      0.9658995742876885,0.9661559646595075,0.9664104943498959,0.9666631758572982,
      0.9669140216112958,0.9671630439727548,0.9674102552339746,0.9676556676188429,
      0.9678992932829918,0.9681411443139596,0.9683812327313545,0.9686195704870232,
      0.9688561694652216,0.9690910414827888,0.9693241982893259,0.9695556515673754,
      0.9697854129326061,0.9700134939339985,0.9702399060540357,0.9704646607088951,
      0.9706877692486436,0.9709092429574353,0.9711290930537122,0.9713473306904065,
      0.9715639669551474,0.9717790128704671,0.9719924793940118,0.9722043774187549,
      0.9724147177732099,0.9726235112216486,0.9728307684643189,0.9730365001376665,
      0.9732407168145568,0.9734434290045008,0.9736446471538801,0.9738443816461771,
      0.9740426428022031,0.9742394408803315,0.9744347860767304,0.9746286885255978,
      0.9748211582993981,0.9750122054090997,0.9752018398044143,0.975390071374038,
      0.9755769099458929,0.9757623652873698,0.9759464471055739,0.976129165047569,
      0.9763105287006256,0.9764905475924671,0.9766692311915195,0.9768465889071616,
      0.9770226300899744,0.9771973640319939,0.9773707999669629,0.9775429470705839,
      0.9777138144607745,0.9778834111979205,0.9780517462851323,0.9782188286685003,
      0.9783846672373524,0.9785492708245106,0.9787126482065489,0.9788748081040518,
      0.9790357591818724,0.9791955100493928,0.9793540692607815,0.9795114453152562,
      0.9796676466573412,0.97982268167713,0.9799765587105447,0.980129286039598,
      0.9802808718926534,0.9804313244446876,0.9805806518175514,0.9807288620802312,
      0.9808759632491112,0.9810219632882344,0.9811668701095654,0.9813106915732508,
      0.9814534354878828,0.9815951096107584,0.9817357216481429,0.9818752792555313
    ];

    List(type: float, size=512) sig_neg = [
      0.5,0.4980468849340468,0.49609382947091957,0.49414089320616855,
      0.4921881357207956,0.49023561657398396,0.48828339529583464,0.48633153138010954,
      0.4843800842769844,0.4824291133858136,0.48047867804790706,0.47852883753932274,
      0.47657965106367606,0.4746311777449677,0.4726834766204329,0.47073660663341144,
      0.46879062662624377,0.4668455953331918,0.4649015713733885,0.46295861324381593,
      0.461016779312316,0.4590761278106335,0.45713671682749474,0.45519860430172193,
      0.45326184801538616,0.4513265055870016,0.44939263446475963,0.4474602919198078,
      0.4455295350395727,0.44360042072113065,0.4416730056646256,0.4397473463667375,
      0.43782349911420193,0.4359015199773826,0.43398146480389854,0.4320633892123068,
      0.43014734858584286,0.42823339806622046,0.42632159254749036,0.42441198666996216,
      0.4225046348141883,0.42059959109501305,0.4186969093556867,0.416796643162047,
      0.4148988457967688,0.4130035702536834,0.411110869232168,0.4092207951316078,
      0.40733340004593027,0.40544873575821444,0.40356685373537454,0.4016878051229205,
      0.399811640739795,0.3979384110732902,0.39606816627404173,0.3942009561511044,
      0.39233683016710835,0.3904758374334973,0.3886180267058489,0.38676344637927973,
      0.3849121444839335,0.3830641686805551,0.38121956625614994,0.3793783841197297,
      0.3775406687981454,0.37570646643200795,0.3738758227716966,0.3720487831734568,
      0.37022539259558657,0.3684056955947133,0.36658973632215985,0.3647775585204021,
      0.3629692055196168,0.3611647202343208,0.35936414516010196,0.3575675223704418,
      0.35577489351363034,0.3539862998097729,0.35220178204788966,0.35042138058310773,
      0.34864513533394575,0.34687308577969156,0.34510527095787247,0.3433417294618181,
      0.341582499438317,0.33982761858536475,0.3380771241500058,0.33633105292626736,
      0.334589441253186,0.33285232501292616,0.3311197396289915,0.329391720064527,
      0.3276683008207139,0.3259495159352553,0.32423539898095244,0.3225259830643727,
      0.320821300824607,0.3191213844321178,0.31742626558767584,0.31573597552138716,
      0.31405054499180746,0.31237000428514555,0.31069438321455395,0.3090237111195067,
      0.30735801686526387,0.30569732884242146,0.30404167496654744,0.30239108267790193,
      0.3007455789412415,0.2991051902457072,0.2974699426047947,0.2958398615564072,
      0.29421497216298875,0.29259529901173903,0.29098086621490676,0.2893716974101632,
      0.2877678157610531,0.286169243957523,0.28457600421652673,0.28298811828270554,
      0.28140560742914383,0.2798284924581987,0.2782567937024021,0.2766905310254354,
      0.2751297238231752,0.27357439102480946,0.2720245510940225,0.27048022203024913,
      0.2689414213699951,0.2674081661882255,0.26588047309981694,0.2643583582610753,
      0.26284183737131667,0.26133092567451033,0.25982563796098374,0.2583259885691872,
      0.25683199138751883,0.25534365985620666,0.2538610069692489,0.2523840452764101,
      0.25091278688527247,0.24944724346334116,0.24798742624020273,0.24653334600973578,
      0.24508501313237172,0.24364243753740636,0.24220562872535947,0.24077459577038227,
      0.23934934732271163,0.2379298916111697,0.2365162364457076,0.23510838921999314,
      0.2337063569140403,0.23231014609688014,0.23091976292927177,0.2295352131664525,
      0.22815650216092537,0.22678363486528472,0.2254166158350767,0.22405544923169474,
      0.22270013882530884,0.22135068799782798,0.22000709974589316,0.21866937668390204,
      0.2173375210470625,0.21601153469447487,0.21469141911224196,0.21337717541660495,
      0.21206880435710532,0.2107663063197709,0.20946968133032529,0.20817892905742003,
      0.2068940488158881,0.20561503957001773,0.20434189993684584,0.2030746281894702,
      0.20181322226037884,0.2005576797447963,0.19930799790404563,0.19806417366892506,
      0.19682620364309852,0.19559408410649906,0.19436781101874467,0.19314738002256465,
      0.19193278644723683,0.19072402531203367,0.18952109132967757,0.1883239789098031,
      0.18713268216242657,0.1859471949014217,0.184767510648,0.18359362263419612,
      0.18242552380635635,0.1812632068286302,0.18010666408646395,0.1789558876900955,
      0.17781086947804958,0.17667160102063315,0.17553807362342935,0.17441027833079015,
      0.1732882059293266,0.17217184695139576,0.17106119167858438,0.16995623014518763,
      0.16885695214168317,0.16776334721819922,0.16667540468797667,0.16559311363082369,
      0.16451646289656316,0.1634454411084719,0.16238003666671086,0.16132023775174628,
      0.1602660323277607,0.15921740814605376,0.1581743527484317,0.1571368534705856,
      0.1561048974454574,0.15507847160659358,0.15405756269148543,0.15304215724489628,
      0.15203224162217424,0.15102780199255095,0.1500288243424251,0.14903529447863062,
      0.14804719803168948,0.14706452045904775,0.14608724704829568,0.14511536292037017,
      0.14414885303274058,0.1431877021825763,0.14223189500989633,0.1412814160007008,
      0.1403362494900832,0.13939637966532398,0.13846179056896438,0.13753246610186087,
      0.13660839002621936,0.13568954596860924,0.1347759174229568,0.13386748775351784,
      0.13296424019782926,0.13206615786963916,0.13117322376181564,0.13028542074923347,
      0.12940273159163906,0.1285251389364931,0.12765262532179067,0.126785173178859,
      0.12592276483513232,0.12506538251690355,0.1242130083520534,0.1233656243727556,
      0.12252321251815919,0.12168575463704703,0.12085323249047067,0.12002562775436143,
      0.11920292202211755,0.1183850968071675,0.11757213354550881,0.11676401359822318,
      0.11596071825396675,0.11516222873143662,0.11436852618181248,0.11357959169117389,
      0.11279540628289322,0.1120159509200037,0.11124120650754304,0.11047115389487246,
      0.10970577387797076,0.10894504720170402,0.10818895456207037,0.10743747660842012,
      0.10669059394565118,0.10594828713637978,0.10521053670308636,0.10447732313023693,
      0.1037486268663797,0.1030244283262171,0.10230470789265304,0.10158944591881584,
      0.10087862273005652,0.1001722186259225,0.09947021388210706,0.09877258875237435,
      0.09807932347046003,0.09739039825194779,0.09670579329612157,0.09602548878779378,
      0.09534946489910949,0.0946777017913266,0.09401017961657226,0.09334687851957547,
      0.09268777863937604,0.09203286011100995,0.09138210306717136,0.09073548763985105,
      0.09009299396195182,0.08945460216888064,0.08882029240011773,0.08819004480076281,
      0.08756383952305867,0.08694165672789168,0.08632347658627028,0.08570927928078065,
      0.08509904500702024,0.08449275397500926,0.08389038641057993,0.08329192255674409,
      0.08269734267503885,0.08210662704685086,0.08151975597471893,0.08093670978361556,
      0.08035746882220708,0.079782013464093,0.07921032410902436,0.07864238118410145,
      0.07807816514495095,0.07751765647688268,0.07696083569602614,0.07640768335044701,
      0.07585818002124355,0.07531230632362354,0.07477004290796137,0.07423137046083579,
      0.07369626970604846,0.0731647214056233,0.07263670636078697,0.07211220541293051,
      0.07159119944455247,0.07107366938018354,0.07055959618729296,0.07004896087717674,
      0.06954174450582809,0.06903792817478999,0.06853749303199023,0.06804042027255897,
      0.0675466911396291,0.06705628692511957,0.06656918897050167,0.06608537866754877,
      0.0656048374590693,0.0651275468396235,0.06465348835622392,0.06418264360901972,
      0.06371499425196533,0.06325052199347325,0.06278920859705135,0.06233103588192477,
      0.06187598572364272,0.061424040054670184,0.06097518086496481,0.06052939020253899,
      0.060086650174007626,0.0596469429451214,0.059210250741285934,0.05877655584806683,
      0.05834584061168106,0.05791808743947444,0.05749327880038582,0.0570713972253977,
      0.05665242530797383,0.05623634570448376,0.05582314113461443,0.05541279438176918,
      0.05500528829345414,0.054600605781652364,0.054198729823185576,0.053799643460064,
      0.05340332979982423,0.05300977201585541,0.052618953347713764,0.052230857101425734,
      0.05184546664977984,0.05146276543260744,0.05108273695705249,0.050705364797830506,
      0.05033063259747688,0.0499585240665846,0.049589022984031735,0.04922211319719861,
      0.048857778622174906,0.048496003243956885,0.04813677111663481,0.04778006636357074,
      0.04742587317756678,0.04707417582102406,0.04672495862609241,0.046378205994811086,
      0.04603390239924038,0.045692032381584625,0.04535258055430642,0.04501553160023231,
      0.044680870272650205,0.04434858139539836,0.04401864986294638,0.04369106064046812,
      0.04336579876390677,0.043042849340032184,0.042722197546490565,0.04240382863184671,
      0.042087727915618836,0.04177388078830622,0.04146227271140963,0.04115288921744486,
      0.040845715909949315,0.04054073846348187,0.04023794262361602,0.0399373142069266,
      0.03963883910097002,0.039342503264258206,0.03904829272622639,0.03875619358719477,
      0.03846619201832429,0.038178274261566426,0.037892426629607394,0.03760863550580657,
      0.03732688734412946,0.037047168669075196,0.036769466075598736,0.03649376622902781,
      0.03622005586497474,0.035948321789243294,0.035678550877730524,0.03541073007632382,
      0.03514484640079327,0.03488088693667929,0.03461883883917583,0.03435868933300902,
      0.03410042571231152,0.03384403534049259,0.033589505650103976,0.03333682414270177,
      0.033085978388704126,0.03283695602724524,0.032589744766025344,0.032344332381157095,
      0.03210070671700818,0.03185885568604045,0.03161876726864549,0.031380429512976746,
      0.03114383053477846,0.03090895851721117,0.030675801710674105,0.030444348432624533,
      0.030214587067393973,0.029986506066001513,0.02976009394596422,0.029535339291104776,
      0.02931223075135632,0.02909075704256467,0.028870906946287904,0.02865266930959345,
      0.02843603304485266,0.028220987129533047,0.028007520605988132,0.027795622581245058,
      0.027585282226789992,0.02737648877835136,0.027169231535681047,0.026963499862333547,
      0.026759283185443152,0.02655657099549924,0.026355352846119753,0.02615561835382285,
      0.02595735719779685,0.02576055911966849,0.025565213923269593,0.025371311474402143,
      0.025178841700601858,0.024987794590900315,0.02479816019558566,0.024609928625961945,
      0.02442309005410721,0.02423763471263024,0.024053552894426174,0.023870834952430912,
      0.023689471299374428,0.02350945240753301,0.02333076880848049,0.023153411092838465,
      0.022977369910025615,0.02280263596800613,0.022629200033037256,0.022457052929416074,
      0.02228618553922549,0.02211658880207952,0.02194825371486785,0.0217811713314998,
      0.021615332762647654,0.021450729175489416,0.02128735179345105,0.02112519189594821,
      0.020964240818127502,0.020804489950607352,0.020645930739218447,0.020488554684743848,
      0.020332353342658753,0.02017731832286999,0.020023441289455244,0.019870713960402048,
      0.019719128107346592,0.019568675555312352,0.019419348182448604,0.019271137919768803,
      0.019124036750888904,0.018978036711765626,0.018833129890434692,0.018689308426749082,
      0.018546564512117298,0.018404890389241722,0.01826427835185701,0.018124720744468643
    ];

    function as_index(float e) --> int
    var idx:= ((e * 128.0) as int) - 1:
      if idx < 512 then
        idx
      else
        511
      end
    end


    lookup:action Exponent:[e] ==> Sig:[v]
    var float v := 0.0
    do
      if (e > 0.0) then
        if (e >= 4.0) then
          v := 1.0;
        else
          v := sig_pos[as_index(e)];
        end
      else
        if (e < -4.0) then
          v := 0.0;
        else
          v := sig_neg[as_index(-e)];
        end
      end
    end

  end

end